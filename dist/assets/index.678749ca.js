var be=Object.defineProperty,we=Object.defineProperties;var ke=Object.getOwnPropertyDescriptors;var oe=Object.getOwnPropertySymbols;var Se=Object.prototype.hasOwnProperty,Te=Object.prototype.propertyIsEnumerable;var ae=(e,o,s)=>o in e?be(e,o,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[o]=s,y=(e,o)=>{for(var s in o||(o={}))Se.call(o,s)&&ae(e,s,o[s]);if(oe)for(var s of oe(o))Te.call(o,s)&&ae(e,s,o[s]);return e},j=(e,o)=>we(e,ke(o));import{Y as ce,Q as B,s as Ae,S as Ee,f as Re,l as je,k as Pe,u as le,g as Ue,n as Le,r as v,h as Ie,i as Oe,ag as V,ah as Z,j as p,a as c,ai as De,B as J,p as ie}from"./index.dc867373.js";import{_ as Fe}from"./ClipLoader.43d2a8c9.js";import{S as Me}from"./success.0e72c282.js";import{E as Be}from"./error.38595cb0.js";import{S as Ve,c as te}from"./chroma.27172217.js";import"./emotion-react.browser.esm.e0d4ebea.js";var ue={},ne={},re=34,q=10,se=13;function de(e){return new Function("d","return {"+e.map(function(o,s){return JSON.stringify(o)+": d["+s+'] || ""'}).join(",")+"}")}function We(e,o){var s=de(e);return function(i,m){return o(s(i),m,e)}}function me(e){var o=Object.create(null),s=[];return e.forEach(function(i){for(var m in i)m in o||s.push(o[m]=m)}),s}function C(e,o){var s=e+"",i=s.length;return i<o?new Array(o-i+1).join(0)+s:s}function _e(e){return e<0?"-"+C(-e,6):e>9999?"+"+C(e,6):C(e,4)}function $e(e){var o=e.getUTCHours(),s=e.getUTCMinutes(),i=e.getUTCSeconds(),m=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":_e(e.getUTCFullYear())+"-"+C(e.getUTCMonth()+1,2)+"-"+C(e.getUTCDate(),2)+(m?"T"+C(o,2)+":"+C(s,2)+":"+C(i,2)+"."+C(m,3)+"Z":i?"T"+C(o,2)+":"+C(s,2)+":"+C(i,2)+"Z":s||o?"T"+C(o,2)+":"+C(s,2)+"Z":"")}function Ke(e){var o=new RegExp('["'+e+`
\r]`),s=e.charCodeAt(0);function i(n,u){var S,d,f=m(n,function(A,N){if(S)return S(A,N-1);d=A,S=u?We(A,u):de(A)});return f.columns=d||[],f}function m(n,u){var S=[],d=n.length,f=0,A=0,N,F=d<=0,E=!1;n.charCodeAt(d-1)===q&&--d,n.charCodeAt(d-1)===se&&--d;function G(){if(F)return ne;if(E)return E=!1,ue;var M,I=f,P;if(n.charCodeAt(I)===re){for(;f++<d&&n.charCodeAt(f)!==re||n.charCodeAt(++f)===re;);return(M=f)>=d?F=!0:(P=n.charCodeAt(f++))===q?E=!0:P===se&&(E=!0,n.charCodeAt(f)===q&&++f),n.slice(I+1,M-1).replace(/""/g,'"')}for(;f<d;){if((P=n.charCodeAt(M=f++))===q)E=!0;else if(P===se)E=!0,n.charCodeAt(f)===q&&++f;else if(P!==s)continue;return n.slice(I,M)}return F=!0,n.slice(I,d)}for(;(N=G())!==ne;){for(var R=[];N!==ue&&N!==ne;)R.push(N),N=G();u&&(R=u(R,A++))==null||S.push(R)}return S}function k(n,u){return n.map(function(S){return u.map(function(d){return L(S[d])}).join(e)})}function g(n,u){return u==null&&(u=me(n)),[u.map(L).join(e)].concat(k(n,u)).join(`
`)}function w(n,u){return u==null&&(u=me(n)),k(n,u).join(`
`)}function D(n){return n.map(Q).join(`
`)}function Q(n){return n.map(L).join(e)}function L(n){return n==null?"":n instanceof Date?$e(n):o.test(n+="")?'"'+n.replace(/"/g,'""')+'"':n}return{parse:i,parseRows:m,format:g,formatBody:w,formatRows:D,formatRow:Q,formatValue:L}}var Ye=Ke(","),Ze=Ye.parse;function qe(e){if(!e.ok)throw new Error(e.status+" "+e.statusText);return e.text()}function Qe(e,o){return fetch(e,o).then(qe)}function Ge(e){return function(o,s,i){return arguments.length===2&&typeof s=="function"&&(i=s,s=void 0),Qe(o,s).then(function(m){return e(m,i)})}}var He=Ge(Ze);class Je{static async Import(o){return new Promise(async(s,i)=>{const m=URL.createObjectURL(o),k=await He(m);if(k)if(k.columns.join(";").toLowerCase().includes("name;address;amount;coin;amount2;coin2")){const g=[];for(let w=0;w<k.length;w++){const D=k[w];D?g.push(D):i(new Error("Row is null"))}s(g)}else i(new Error("Columns are invalid. Please, set the column order like that: Name Address Amount Coin"));else i(new Error("Cannot import an empty file"))})}}const ot=()=>{const{walletType:e}=ce.useContractKit(),o=B(Ae),s=B(Ee),i=B(Re),m=je(),k=Pe(),{GetCoins:g}=le(),w=B(Ue),{SendTransaction:D,SendBatchTransaction:Q}=le(),{submitTransaction:L}=Le(),[n,u]=v.exports.useState(1),[S,d]=v.exports.useState(!1),[f,A]=v.exports.useState(!1),[N,F]=v.exports.useState(!1),[E,G]=v.exports.useState([]),R=B(Ie),M=B(Oe),[I,P]=v.exports.useState([]),U=v.exports.useRef([V.generate(),V.generate()]),W=v.exports.useRef([]),_=v.exports.useRef([]),[O,$]=v.exports.useState([]),K=v.exports.useRef([]),[z,fe]=v.exports.useState([]),X=v.exports.useRef(null),pe=()=>{W.current=[],_.current=[],K.current=[],U.current=[],$([])},ee=ce.WalletTypes.PrivateKey===e;v.exports.useEffect(()=>{if(z.length>0&&g){const t=z.filter(a=>a.address&&a.amount&&a.coin);pe();const r=[],l=[];for(let a=0;a<t.length;a++){const{name:T,address:b,amount:Y,coin:h,amount2:x,coin2:H}=t[a];U.current.push(V.generate()),U.current.push(V.generate()),W.current.push(T||""),_.current.push(b||""),K.current.push(Y||""),l.push(parseFloat(Y||"0")),W.current.push(T||""),_.current.push(b||""),K.current.push(x||""),l.push(parseFloat(x||"0"));const ye=j(y({},g[h]),{type:g[h].name}),Ce=j(y({},g[H]),{type:g[H].name}),Ne=[ye,Ce];r.push(...Ne),P(l)}u((n===1?0:n)+t.length),$(r),X.current.files=new DataTransfer().files}},[z]),v.exports.useEffect(()=>{if(w&&Object.keys(w).length>0){const t=Object.values(w).map(l=>({name:`${l.amount.toFixed(3)} ${l.coins.name}`,type:l.coins.name.toString(),amount:l.amount.toString(),coinUrl:l.coins.coinUrl})),r={name:t[0].name.split(" ")[1],coinUrl:t[0].coinUrl};if(ee){const l={name:Z.CELO_v2.name,coinUrl:Z.CELO_v2.coinUrl,type:Z.CELO_v2.type};$([y({},l),y({},l)])}else $([y({},r),y({},r)])}},[w]);const he=async t=>{var r,l;t.preventDefault(),d(!0);try{const a=[],[T,b,Y]=[W.current,_.current,K.current];for(let h=0;h<b.length;h++)if(b[h]&&Y[h]&&O[h].name){let x=Y[h];if(N){let H=(l=(r=w[O[h].name])==null?void 0:r.tokenPrice)!=null?l:1;x=(parseFloat(x)/H).toFixed(4)}a.push({toAddress:b[h],amount:x,tokenName:O[h].name})}if(!g)return;if(o.accountAddress.toLowerCase()===s.toLowerCase()){if(a.length===1)await D({coin:ee?Z[a[0].tokenName]:g[a[0].tokenName],recipient:a[0].toAddress,amount:a[0].amount},void 0,E);else if(a.length>1){const h=a.map(x=>({coin:ee?Z[x.tokenName]:g[x.tokenName],recipient:x.toAddress,amount:x.amount,from:!0}));await Q(h,void 0,E)}}else if(a.length===1)await L(s,[{recipient:a[0].toAddress,amount:a[0].amount,coin:g[a[0].tokenName]}]);else if(a.length>1){const h=a.map(x=>({coin:g[x.tokenName],recipient:x.toAddress,amount:x.amount,from:!0}));await L(s,h)}A(!0)}catch(a){console.error(a),m(ie({activate:!0,text:a.message}))}d(!1)},ge={control:t=>j(y({},t),{boxShadow:"none",border:"1px solid #1C1C1C","&:hover":{border:"1px solid #1C1C1C"},backgroundColor:M?"text-dark":"white"}),option:(t,{data:r,isDisabled:l,isFocused:a,isSelected:T})=>{const b=te(r.color);return j(y({},t),{outline:"none",border:"none",backgroundColor:l?void 0:T?r.color:a?b.alpha(.1).css():void 0,color:l?"#ccc":T?te.contrast(b,"white")>2?"white":"black":r.color,cursor:l?"not-allowed":"default",":active":j(y({},t[":active"]),{backgroundColor:l?void 0:T?r.color:b.alpha(.3).css()})})},multiValue:(t,{data:r})=>{const l=te(r.color);return j(y({},t),{backgroundColor:l.alpha(0).css()})},multiValueLabel:(t,{data:r})=>y(j(y({},t),{color:r.color}),xe(r.color)),multiValueRemove:(t,{data:r})=>j(y({},t),{color:r.color,":hover":{backgroundColor:r.color,color:"white"}})},xe=(t="transparent")=>({alignItems:"center",display:"flex",":before":{backgroundColor:t,borderRadius:10,content:'" "',display:"block",marginRight:8,height:10,width:10}}),ve=t=>{G(t.map(r=>({color:r.color,id:r.value,name:r.label,transactions:r.transactions,isDefault:r.isDefault})))};return p("div",{className:"sm:px-32",children:[c("form",{onSubmit:he,children:c("div",{className:"sm:flex flex-col items-center justify-center min-h-screen py-10",children:p("div",{className:"sm:min-w-[85vw] min-h-[75vh] h-auto ",children:[c("div",{className:"py-2 text-center w-full",children:c("div",{className:"text-xl font-semibold",children:"Pay Someone"})}),p("div",{className:"sm:flex flex-col gap-3 gap-y-10 sm:gap-10 py-10",children:[p("div",{className:"sm:flex flex-col pl-3 sm:pl-12 sm:pr-[20%] gap-3 gap-y-10  sm:gap-10",children:[p("div",{className:"flex flex-col space-y-5",children:[c("span",{className:"text-left text-sm font-semibold",children:"Payment Type"}),p("div",{className:"flex space-x-24",children:[p("div",{className:"flex space-x-2 items-center",children:[c("input",{type:"radio",className:"w-4 h-4 accent-[#ff501a] cursor-pointer peer",name:"paymentType",value:"token",onChange:t=>F(!1),checked:!N}),c("label",{className:"font-semibold text-sm peer-checked:text-primary",children:"Pay with Token Amounts"})]}),p("div",{className:"flex space-x-2 items-center",children:[c("input",{type:"radio",className:"w-4 h-4 accent-[#ff501a] cursor-pointer peer",name:"paymentType",value:"fiat",onChange:t=>F(!0),checked:N}),c("label",{className:"font-semibold text-sm peer-checked:text-primary",children:"Pay with USD-based Amounts"})]})]})]}),p("div",{className:"flex flex-col space-y-3",children:[c("span",{className:"text-left text-sm font-semibold",children:"Tags"}),p("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-x-3 sm:gap-x-10",children:[R&&R.length>0&&c(Ve,{closeMenuOnSelect:!1,isMulti:!0,isClearable:!1,options:R.map(t=>({value:t.id,label:t.name,color:t.color,transactions:t.transactions,isDefault:t.isDefault})),styles:ge,onChange:ve}),R.length===0&&c("div",{children:"No tag yet"})]})]}),p("div",{className:"flex flex-col",children:[p("div",{className:"flex space-x-5 sm:space-x-0 sm:justify-between py-4 items-center",children:[c("span",{className:"text-left font-semibold text-sm",children:"Paying To"}),c("input",{ref:X,type:"file",className:"hidden",onChange:t=>t.target.files.length>0?Je.Import(t.target.files[0]).then(r=>fe(r)).catch(r=>console.error(r)):null})]}),c("div",{className:"grid grid-cols-4 sm:grid-cols-[25%,35%,35%,5%] gap-5",children:O.length>0&&n?Array(n).fill(" ").map((t,r)=>(U.current[r*2]||(U.current[r*2]=V.generate(),U.current[r*2+1]=V.generate()),c(De,{amountState:I,setAmount:P,setIndex:u,overallIndex:n,uniqueArr:U.current,index:r*2,name:W.current,address:_.current,amount:K.current,selectedWallet:O,setWallet:$,isBasedOnDollar:N},U.current[r*2]))):c("div",{children:c(Fe,{})})})]}),p("div",{className:"py-5 sm:py-0 grid grid-cols-[65%,35%] gap-16",children:[p("div",{className:"flex space-x-5",children:[c(J,{version:"second",className:"min-w-[12.5rem] text-left !px-6 font-semibold tracking-wide shadow-none",onClick:()=>{u(n+1)},children:"+ Add More"}),c(J,{version:"second",onClick:()=>{var t;(t=X.current)==null||t.click()},className:"min-w-[12.5rem] text-left !px-6 font-semibold tracking-wide shadow-none",children:"Import CSV file"})]}),p("span",{className:"self-center text-lg opacity-60",children:["Total: $",I.reduce((t,r,l)=>{var a,T,b;return(a=O[l])!=null&&a.name?N?t+r:t+r*((b=(T=w[O[l].name])==null?void 0:T.tokenPrice)!=null?b:1):t},0).toFixed(2)]})]}),p("div",{className:"flex flex-col space-y-3",children:[c("span",{className:"text-left",children:"Description (Optional)"}),c("div",{className:"grid grid-cols-1",children:c("textarea",{placeholder:"Paid 50 CELO to Ermak.....",className:"border-2 dark:border-darkSecond rounded-xl p-3 outline-none dark:bg-darkSecond",name:"description",id:"",cols:28,rows:5})})]})]}),c("div",{className:"flex justify-center pt-5 sm:pt-0",children:p("div",{className:"flex flex-col-reverse sm:grid grid-cols-2 w-[12.5rem] sm:w-[25rem] justify-center gap-5",children:[c(J,{version:"second",onClick:()=>k("/dashboard"),children:"Close"}),c(J,{type:"submit",className:"bg-primary px-3 py-2 text-white flex items-center justify-center rounded-lg",isLoading:S,children:"Pay"})]})})]})]})})}),f&&c(Me,{onClose:A,onAction:()=>{k("/dashboard")}}),i&&c(Be,{onClose:t=>m(ie({activate:t,text:""}))})]})};export{ot as default};
