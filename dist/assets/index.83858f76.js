import{r,aP as w,aQ as g,aR as B,aS as G,aT as T,aU as V,aV as Q,aW as W,aX as X,aY as Y}from"./index.dc867373.js";function F(){var e=r.exports.useRef(!1);return w(function(){return e.current=!0,function(){e.current=!1}},[]),e}function b(){var e=F(),u=g(r.exports.useState(0),2),o=u[0],s=u[1],a=r.exports.useCallback(function(){e.current&&s(o+1)},[o]),v=r.exports.useCallback(function(){return B.postRender(a)},[a]);return[v,o]}var M=function(e){var u=e.children,o=e.initial,s=e.isPresent,a=e.onExitComplete,v=e.custom,h=e.presenceAffectsLayout,i=G(j),m=T(),R=r.exports.useMemo(function(){return{id:m,initial:o,isPresent:s,custom:v,onExitComplete:function(l){var d,C;i.set(l,!0);try{for(var c=V(i.values()),t=c.next();!t.done;t=c.next()){var f=t.value;if(!f)return}}catch(p){d={error:p}}finally{try{t&&!t.done&&(C=c.return)&&C.call(c)}finally{if(d)throw d.error}}a==null||a()},register:function(l){return i.set(l,!1),function(){return i.delete(l)}}}},h?void 0:[s]);return r.exports.useMemo(function(){i.forEach(function(l,d){return i.set(d,!1)})},[s]),r.exports.useEffect(function(){!s&&!i.size&&(a==null||a())},[s]),r.exports.createElement(Q.Provider,{value:R},u)};function j(){return new Map}var x=function(e){return e.key||""};function q(e,u){e.forEach(function(o){var s=x(o);u.set(s,o)})}function D(e){var u=[];return r.exports.Children.forEach(e,function(o){r.exports.isValidElement(o)&&u.push(o)}),u}var J=function(e){var u=e.children,o=e.custom,s=e.initial,a=s===void 0?!0:s,v=e.onExitComplete,h=e.exitBeforeEnter,i=e.presenceAffectsLayout,m=i===void 0?!0:i,R=g(b(),1),l=R[0],d=r.exports.useContext(W).forceRender;d&&(l=d);var C=F(),c=D(u),t=c,f=new Set,p=r.exports.useRef(t),y=r.exports.useRef(new Map).current,P=r.exports.useRef(!0);if(w(function(){P.current=!1,q(c,y),p.current=t}),X(function(){P.current=!0,y.clear(),f.clear()}),P.current)return r.exports.createElement(r.exports.Fragment,null,t.map(function(n){return r.exports.createElement(M,{key:x(n),isPresent:!0,initial:a?void 0:!1,presenceAffectsLayout:m},n)}));t=Y([],g(t),!1);for(var L=p.current.map(x),I=c.map(x),z=L.length,A=0;A<z;A++){var k=L[A];I.indexOf(k)===-1&&f.add(k)}return h&&f.size&&(t=[]),f.forEach(function(n){if(I.indexOf(n)===-1){var E=y.get(n);if(!!E){var K=L.indexOf(n),O=function(){y.delete(n),f.delete(n);var S=p.current.findIndex(function(U){return U.key===n});if(p.current.splice(S,1),!f.size){if(p.current=c,C.current===!1)return;l(),v&&v()}};t.splice(K,0,r.exports.createElement(M,{key:x(E),isPresent:!1,onExitComplete:O,custom:o,presenceAffectsLayout:m},E))}}}),t=t.map(function(n){var E=n.key;return f.has(E)?n:r.exports.createElement(M,{key:x(n),isPresent:!0,presenceAffectsLayout:m},n)}),r.exports.createElement(r.exports.Fragment,null,f.size?t:t.map(function(n){return r.exports.cloneElement(n)}))};export{J as A};
