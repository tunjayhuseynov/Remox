var me=Object.defineProperty,ue=Object.defineProperties;var pe=Object.getOwnPropertyDescriptors;var ae=Object.getOwnPropertySymbols;var he=Object.prototype.hasOwnProperty,fe=Object.prototype.propertyIsEnumerable;var se=(l,o,i)=>o in l?me(l,o,{enumerable:!0,configurable:!0,writable:!0,value:i}):l[o]=i,J=(l,o)=>{for(var i in o||(o={}))he.call(o,i)&&se(l,i,o[i]);if(ae)for(var i of ae(o))fe.call(o,i)&&se(l,i,o[i]);return l},V=(l,o)=>ue(l,pe(o));import{e as oe,g as xe,K as ne,L as le,N as ce,r as n,O as p,P as C,t as Y,a as r,F as ie,j as u,b as be,h as ye,C as ge,Q as Ne,S as ve}from"./index.dc867373.js";import{u as de,W as we}from"./walletdropdown.ddfc83af.js";import{g as De,C as re}from"./chart.439d8145.js";import{u as Ce}from"./useMultiWallet.40ef7dbb.js";const Se=({selectedDate:l,selectedAccounts:o})=>{const i=oe(xe),{fetchedBalance:k}=ne(o),q=le(),{list:h}=de(o),{AllPrices:N,TotalBalance:b}=ce(k,q),f=N,W=b,[A,U]=n.exports.useState(0),[I,G]=n.exports.useState(0),z=n.exports.useMemo(()=>{if(h&&h.length>0){let t=0,x=h[0],c=Math.ceil(new Date().getTime()/1e3);h.forEach(s=>{var T,y,F,w;if(Number(s.rawData.timeStamp)<c&&(c=Number(s.rawData.timeStamp),x=s),o.some(D=>D.toLowerCase()===s.rawData.from.toLowerCase())&&f){if(s.id===p.transfer||s.id===p.transferFrom||s.id===p.transferWithComment){const D=s;t+=Number(C(D.amount))*Number((y=(T=f[D.rawData.tokenSymbol])==null?void 0:T.price)!=null?y:1)}s.id===p.noInput&&(t+=Number(C(s.rawData.value))*Number((w=(F=f[s.rawData.tokenSymbol])==null?void 0:F.price)!=null?w:1)),s.id===p.batchRequest&&s.payments.forEach(R=>{var e,d;t+=Number(C(R.amount))*Number((d=(e=f[R.coinAddress.name])==null?void 0:e.price)!=null?d:1)})}});const E=Y.subtract(new Date,new Date(Number(x.rawData.timeStamp)*1e3)).toDays(),L=Math.ceil(Math.abs(E)/30);return t/L}else return 0},[h]),H=n.exports.useMemo(()=>{if(h&&h.length>0){let t=h[0],x=Math.ceil(new Date().getTime()/1e3);return h.forEach(c=>{Number(c.rawData.timeStamp)<x&&(x=Number(c.rawData.timeStamp),t=c)}),Math.abs(Y.subtract(new Date,new Date(Number(t.rawData.timeStamp)*1e3)).toDays())/30}else return 0},[h]),v=n.exports.useMemo(()=>{if(f&&i&&i.CELO){const t=Object.values(f),x=Object.values(i);let c=0;return t.reduce((L,s,T)=>(x[T].amount>0&&(L+=s.per_24,c++),L),0)/c}},[i]);n.exports.useEffect(()=>{if(h){let t=0,x=0;h.forEach(c=>{var L,s,T,y;const E=new Date(parseInt(c.rawData.timeStamp)*1e3);if(Math.abs(Y.subtract(new Date,E).toDays())<=l&&f){let F=0;if(c.id===p.transfer||c.id===p.transferFrom||c.id===p.transferWithComment){const w=c;F+=Number(C(w.amount))*Number((s=(L=f[w.rawData.tokenSymbol])==null?void 0:L.price)!=null?s:1)}c.id===p.noInput&&(F+=Number(C(c.rawData.value))*Number((y=(T=f[c.rawData.tokenSymbol])==null?void 0:T.price)!=null?y:1)),c.id===p.batchRequest&&c.payments.forEach(D=>{var R,e;F+=Number(C(D.amount))*Number((e=(R=f[D.coinAddress.name])==null?void 0:R.price)!=null?e:1)}),o.some(w=>w.toLowerCase()===c.rawData.from.toLowerCase())?x+=F:t+=F}}),U(t),G(x)}},[h,f,l]);const _=[{id:"1",header:"Actual total balance",interest:v?`${v}`:void 0,money:W==null?void 0:W.toFixed(2)},{id:"2",header:"Money in",money:A==null?void 0:A.toFixed(2)},{id:"3",header:"Money out",money:I==null?void 0:I.toFixed(2)},{id:4,header:"Net change",money:(A||A===0)&&(I||I===0)?`${(A-I).toFixed(2)}`:""},{id:5,header:"Average monthly spending",money:z==null?void 0:z.toFixed(2)},{id:6,header:"Runway",text:H==null?void 0:H.toFixed(1),endnum:"Months"}];return r(ie,{children:_.map(t=>u("div",{className:"bg-greylish bg-opacity-10 dark:bg-darkSecond rounded-xl h-[6.25rem]  p-3  ",children:[u("div",{className:"flex justify-between",children:[r("p",{className:"font-bold text-sm",children:t.header}),r("p",{style:t.interest&&parseFloat(t.interest)!==0?parseFloat(t.interest)>0?{color:"green"}:{color:"red"}:{color:"black"},children:t.interest&&parseFloat(t.interest)!==0?`${parseFloat(t.interest).toFixed(2)}%`:""})]}),u("h1",{className:"text-2xl pl-2 pt-4 font-bold",children:[t.text," ",t.money?u("span",{children:["$",t.money.split(".")[0],t.money.split(".")[1]&&u("span",{className:"text-greylish text-lg",children:[".",t.money.split(".")[1]]})," "]}):!t.text&&r(be.ClipLoader,{size:"1.5rem"}),"  ",t.endnum&&r("span",{className:"text-greylish opacity-80 tracking-wider text-xl",children:t.endnum})]})]},t.id))})},ke=({selectedDate:l,selectedAccounts:o})=>{const[i,k]=n.exports.useState({datasets:[{data:[0],backgroundColor:[""],borderWidth:0,hoverOffset:0}],labels:[""]}),[q,h]=n.exports.useState({datasets:[{data:[0],backgroundColor:[""],borderWidth:0,hoverOffset:0}],labels:[""]}),N=n.exports.useRef(null),b=n.exports.useRef(null),[f,W]=n.exports.useState(""),[A,U]=n.exports.useState(""),I=n.exports.useCallback((e,d,a)=>g=>{var B;const S=De(e.current,g);if(S.length>0&&S[0].index>0){const m=(B=S[0].index)!=null?B:1;a(d[m].id),e.current.setActiveElements([{datasetIndex:0,index:m}])}else e.current.setActiveElements([]),a("");e.current.update()},[]),{fetchedBalance:G}=ne(o),z=le(),{AllPrices:H}=ce(G,z),v=H,{list:_}=de(o);let t=oe(ye);const[x,c]=n.exports.useState(),[E,L]=n.exports.useState(),[s,T]=n.exports.useState([]),[y,F]=n.exports.useState([]);n.exports.useEffect(()=>{if(_){let e=[],d=[];t.forEach(a=>{let g,S;g=V(J({},a),{txs:[],totalAmount:0}),S=V(J({},a),{txs:[],totalAmount:0}),a.transactions.forEach(B=>{var K,Q,M,$;const m=_.find(P=>P.rawData.hash.toLowerCase()===B.toLowerCase());if(m&&v){const P=new Date(parseInt(m.rawData.timeStamp)*1e3);if(Math.abs(Y.subtract(new Date,P).toDays())<=l){let j=0;if(m.id===p.transfer||m.id===p.transferFrom||m.id===p.transferWithComment){const O=m;j+=Number(C(O.amount))*Number((Q=(K=v[O.rawData.tokenSymbol])==null?void 0:K.price)!=null?Q:1)}m.id===p.noInput&&(j+=Number(C(m.rawData.value))*Number(($=(M=v[m.rawData.tokenSymbol])==null?void 0:M.price)!=null?$:1)),m.id===p.batchRequest&&m.payments.forEach(Z=>{var ee,te;j+=Number(C(Z.amount))*Number((te=(ee=v[Z.coinAddress.name])==null?void 0:ee.price)!=null?te:1)}),o.some(O=>O.toLowerCase()===m.rawData.from.toLowerCase())?(S.txs.push(m),S.totalAmount+=j):(g.txs.push(m),g.totalAmount+=j)}}}),d.push(g),e.push(S)}),T(d),F(e)}},[_,t,l]),n.exports.useEffect(()=>{if(_){let e=0,d=0;_.forEach(a=>{var S,B,m,K,Q;(S=Object.entries(ge).find(M=>M[0]===a.rawData.tokenSymbol))==null||S[1];const g=new Date(parseInt(a.rawData.timeStamp)*1e3);if(Math.abs(Y.subtract(new Date,g).toDays())<=l&&v){let M=0;if(a.id===p.transfer||a.id===p.transferFrom||a.id===p.transferWithComment){const $=a;M+=Number(C($.amount))*Number((m=(B=v[$.rawData.tokenSymbol])==null?void 0:B.price)!=null?m:1)}a.id===p.noInput&&(M+=Number(C(a.rawData.value))*Number((Q=(K=v[a.rawData.tokenSymbol])==null?void 0:K.price)!=null?Q:1)),a.id===p.batchRequest&&a.payments.forEach(P=>{var j,O;M+=Number(C(P.amount))*Number((O=(j=v[P.coinAddress.name])==null?void 0:j.price)!=null?O:1)}),o.some($=>$.toLowerCase()===a.rawData.from.toLowerCase())?d+=M:e+=M}}),c(e),L(d)}},[_,v,l]),n.exports.useEffect(()=>{if(x!==void 0){const d=[],a=[],g=[];for(var e=0;e<s.length;e++)s[e].totalAmount!==0&&(d[e]=s[e].name,g[e]=s[e].color,a[e]=s[e].totalAmount);k({datasets:[{data:a.length>0?a:[100],backgroundColor:a.length>0?g:["#FF7348"],borderWidth:0,hoverOffset:15}],labels:a.length>0?d:["data"]})}},[s,x]),n.exports.useEffect(()=>{if(E!==void 0){const d=[],a=[],g=[];for(var e=0;e<y.length;e++)y[e].totalAmount!==0&&(d[e]=y[e].name,g[e]=y[e].color,a[e]=y[e].totalAmount);h({datasets:[{data:a.length>0?a:[100],backgroundColor:a.length>0?g:["#FF7348"],borderWidth:0,hoverOffset:15}],labels:a.length>0?d:["data"]})}},[y,E]);const w=e=>{N.current&&(e||e===0?N.current.setActiveElements([{datasetIndex:0,index:e}]):N.current.setActiveElements([]),N.current.update())},D=e=>{b.current&&(e||e===0?b.current.setActiveElements([{datasetIndex:0,index:e}]):b.current.setActiveElements([]),b.current.update())};n.exports.useEffect(()=>{f||w(),A||D()},[f,A]);const R=[{id:1,header:"Money in",headermoney:x==null?void 0:x.toFixed(2),chart:r(re,{data:i,ref:N,onClickEvent:I(N,s,W)}),tagList:s,tags:r("div",{className:"flex flex-col gap-3 pt-2 ",children:s.map((e,d)=>u("div",{className:`flex ${f===e.id&&e.totalAmount!==0&&"shadow-[1px_1px_8px_3px_#dad8d8] dark:shadow-[1px_1px_14px_2px_#0000008f] rounded-xl"} p-[2px] px-2 space-x-3 justify-between cursor-pointer`,onMouseOver:()=>{W(e.id),N.current&&e.totalAmount!==0&&w(d)},onMouseLeave:()=>{w(),W("")},children:[u("div",{className:"flex items-center",children:[r("div",{className:"w-[0.625rem] h-[0.625rem] rounded-full ",style:{backgroundColor:e.color}}),r("p",{className:"font-bold pl-2 truncate",children:e.name})]}),u("p",{className:"text-gray-500 font-bold",children:["$ ",e.totalAmount.toFixed(2)]})]},e.id))})},{id:2,header:"Money out",headermoney:E==null?void 0:E.toFixed(2),chart:r(re,{data:q,ref:b,onClickEvent:I(b,y,U)}),tagList:y,tags:r("div",{className:"flex flex-col gap-3 pt-2 ",children:y.map((e,d)=>u("div",{className:`flex ${A===e.id&&e.totalAmount!==0&&"shadow-[1px_1px_8px_3px_#dad8d8] dark:shadow-[1px_1px_14px_2px_#0000008f] rounded-xl"} p-[2px] px-2 space-x-3 justify-between cursor-pointer`,onMouseOver:()=>{U(e.id),b.current&&e.totalAmount!==0&&D(d)},onMouseLeave:()=>{D(),U("")},children:[u("div",{className:"flex items-center",children:[r("div",{className:"w-[0.625rem] h-[0.625rem] rounded-full ",style:{backgroundColor:e.color}}),r("p",{className:"font-bold pl-2 truncate",children:e.name})]}),u("p",{className:"text-gray-500 font-bold",children:["$ ",e.totalAmount.toFixed(2)]})]},e.id))})}];return r(ie,{children:R.map(e=>u("div",{className:"mb-10",children:[r("h1",{className:"text-xl mb-4 font-semibold ",children:e.header}),u("div",{className:"grid grid-cols-2 gap-x-10 px-8 py-5 bg-white dark:bg-darkSecond  drop-shadow-xl rounded-xl",children:[u("div",{className:"flex flex-col",children:[u("div",{className:"flex flex-col",children:[u("h1",{className:"font-bold text-4xl ",children:["$ ",e.headermoney]}),u("p",{className:"text-gray-500  pt-2 text-sm",children:["Total ",e.header]})]}),r("div",{children:e.tags})]}),r("div",{className:"h-full w-full",children:e.chart})]})]},e.id))})},X="py-2 bg-greylish bg-opacity-10 dark:bg-darkSecond px-5  rounded-xl hover:bg-gray-300 dark:hover:bg-greylish dark:focus:bg-greylish",Le=()=>{var N;const[l,o]=n.exports.useState(30),i=Ne(ve),{data:k}=Ce(),[q,h]=n.exports.useState((N=k==null?void 0:k.map(b=>b.address))!=null?N:[i]);return n.exports.useEffect(()=>{k!==void 0&&h(k.map(b=>b.address))},[k]),u("div",{className:"flex flex-col space-y-3",children:[r("div",{className:"text-2xl font-bold tracking-widest pb-4",children:"Insights"}),u("div",{className:"pb-2 pt-2",children:[r("div",{className:"flex justify-end",children:u("div",{className:"flex gap-7",children:[r("button",{onClick:()=>o(30),className:`${l===30?"!bg-greylish !bg-opacity-40 dark:!bg-opacity-100":""} ${X} `,children:"30 Days"}),r("button",{onClick:()=>o(90),className:`${l===90?"!bg-greylish !bg-opacity-40 dark:!bg-opacity-100":""} ${X}`,children:"90 Days"}),r("button",{onClick:()=>o(365),className:`${l===365?"!bg-greylish !bg-opacity-40 dark:!bg-opacity-100":""} ${X}`,children:"1 Year"}),r(we,{selected:i,onChange:b=>{h([...b.map(f=>f.address)])}})]})}),r("div",{className:"grid grid-cols-3 pt-10 pb-10 gap-x-28 gap-y-10",children:r(Se,{selectedDate:l,selectedAccounts:q})}),r("div",{className:"grid xl:grid-cols-2 gap-x-20",children:r(ke,{selectedDate:l,selectedAccounts:q})})]})]})};export{Le as default};
