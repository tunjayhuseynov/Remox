var re=Object.defineProperty,ce=Object.defineProperties;var de=Object.getOwnPropertyDescriptors;var J=Object.getOwnPropertySymbols;var le=Object.prototype.hasOwnProperty,ie=Object.prototype.propertyIsEnumerable;var Q=(t,r,o)=>r in t?re(t,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[r]=o,x=(t,r)=>{for(var o in r||(r={}))le.call(r,o)&&Q(t,o,r[o]);if(J)for(var o of J(r))ie.call(r,o)&&Q(t,o,r[o]);return t},b=(t,r)=>ce(t,de(r));import{u as $,r as y,j as u,F as ae,a as e,b as X,D as q,C as _,c as oe,d as me,e as w,s as ue,S as fe,f as he,g as ye,h as xe,i as be,k as pe,l as ke,m as ge,n as ve,o as Ne,B as Z,p as ee,q as te,t as U,v}from"./index.dc867373.js";import{_ as Se}from"./ClipLoader.43d2a8c9.js";import{S as we}from"./success.0e72c282.js";import{E as Ae}from"./error.38595cb0.js";import"./emotion-react.browser.esm.e0d4ebea.js";const Ce=t=>{const{GetCoins:r}=$(),[o,f]=y.exports.useState({name:r[t.currency].name,coinUrl:r[t.currency].coinUrl}),[n,N]=y.exports.useState();y.exports.useEffect(()=>{t.secondaryCurrency&&N({name:r[t.secondaryCurrency].name,coinUrl:r[t.secondaryCurrency].coinUrl})},[]),y.exports.useEffect(()=>{o&&o.name&&S({val:"",wallet:!0})},[o]),y.exports.useEffect(()=>{n&&n.name&&S({val:"",wallet:!0,is2:!0})},[n]);const S=({val:l,wallet:k=!1,is2:T=!1,customWallet:C})=>{const j=[...t.members].reduce((D,i)=>{if(i.id!==t.id)D.push(i);else{let p;k&&T?C?p=b(x({},i),{secondaryCurrency:C}):p=b(x({},i),{secondaryCurrency:n.name}):!k&&T?p=b(x({},i),{secondaryAmount:l}):k?C?p=b(x({},i),{currency:C}):p=b(x({},i),{currency:o.name}):p=b(x({},i),{amount:l}),D.push(p)}return D},[]);t.setMembers(j)},A=({tick:l})=>{l?t.setSelectedId([...t.selectedId,t.id]):t.setSelectedId(t.selectedId.filter(k=>k!==t.id))};return u(ae,{children:[u("div",{className:"flex items-center",children:[e("input",{checked:t.selectedId.some(l=>l===t.id),className:"relative cursor-pointer w-[1.25rem] h-[1.25rem] checked:before:absolute checked:before:w-full checked:before:h-full dark:text-white checked:before:bg-primary checked:before:block dark:bg-darkSecond",type:"checkbox",onChange:l=>{A({tick:l.target.checked})}}),e("h2",{className:`text-black px-3 py-1 name__${t.index} text-sm dark:text-white`,children:t.name})]}),e("div",{className:"flex items-center",children:e("h2",{className:`text-black py-1 rounded-md address__${t.index} text-sm truncate dark:text-white`,children:t.address})}),u("div",{className:`col-span-2 sm:col-span-1 border dark:bg-darkSecond dark:border-darkSecond text-black py-1 rounded-md grid ${t.usdBase?"grid-cols-[40%,15%,45%]":"grid-cols-[50%,50%]"}`,children:[e("input",{className:"outline-none unvisibleArrow pl-2 dark:bg-darkSecond dark:text-white",placeholder:"Amount",defaultValue:t.amount,type:"number",name:`amount__${t.index}`,onChange:l=>{S({val:l.target.value})},required:!0,step:"any",min:0}),t.usdBase&&e("span",{className:"text-xs self-center opacity-70 dark:text-white",children:"USD as"}),o?e(q,{className:"border-transparent text-sm dark:text-white",onSelect:f,nameActivation:!0,selected:o,list:Object.values(r).map(l=>({name:l.name,coinUrl:l.coinUrl}))}):e(X.ClipLoader,{})]}),e("div",{className:"hidden sm:block"}),e("div",{}),e("div",{}),t.secondaryCurrency&&t.secondaryAmount&&n?u("div",{className:`col-span-2 sm:col-span-1 border dark:bg-darkSecond dark:border-darkSecond text-black py-1 rounded-md grid ${t.usdBase?"grid-cols-[40%,15%,45%]":"grid-cols-[50%,50%]"}`,children:[e("input",{className:"outline-none unvisibleArrow pl-2 dark:bg-darkSecond dark:text-white",placeholder:"Amount",defaultValue:t.secondaryAmount,type:"number",name:`amount__${t.index}`,onChange:l=>{S({val:l.target.value,wallet:!1,is2:!0})},step:"any",min:0}),t.usdBase&&e("span",{className:"text-xs self-center opacity-70 dark:text-white",children:"USD as"}),o?e(q,{className:"border-transparent text-sm dark:text-white",onSelect:N,nameActivation:!0,selected:n,list:Object.values(r).map(l=>({name:l.name,coinUrl:l.coinUrl}))}):e(X.ClipLoader,{})]}):u("div",{className:"text-primary cursor-pointer text-sm",onClick:()=>{N({name:r[_.CELO].name,coinUrl:r[_.CELO].coinUrl}),S({val:"",wallet:!0,is2:!0,customWallet:_.CELO})},children:[" ",e("span",{className:"bg-greylish bg-opacity-5 font-semibold tracking-wide py-3 px-5 text-center rounded-xl",children:"+ Add another token"})]}),e("div",{}),e("div",{}),e("div",{}),e("div",{}),e("div",{})]})},Le=()=>{var z;const{state:t}=oe(),r=t==null?void 0:t.memberList,{editMember:o}=me(),{GetCoins:f}=$(),n=w(ue),N=w(fe),S=w(he),A=w(ye),l=w(xe);w(be);const k=pe(),T=ke(),[C]=ge(),{SendBatchTransaction:V,SendTransaction:j}=$(),{submitTransaction:D}=ve(),i=w(Ne).contributors,[p,W]=y.exports.useState(!1),[se,G]=y.exports.useState(!1),[g,R]=y.exports.useState(r?{name:"Custom",address:"0"}:void 0),[M,Y]=y.exports.useState(r?r.map(c=>b(x({},c),{selected:!1})):[]),[K,ne]=y.exports.useState(r),[B,F]=y.exports.useState(r?r.map(c=>c.id):[]);return y.exports.useEffect(()=>{i&&i.length&&!r&&R({name:i[0].name,address:i[0].id})},[i]),y.exports.useEffect(()=>{if(i&&i.length&&g&&g.address&&g.name.toLowerCase()!=="custom"){const c=i.find(s=>s.id===g.address);c&&c.members&&Y(c.members.map(s=>b(x({},s),{selected:!1}))),ne(i.find(s=>s.id===g.address).members)}},[g,i]),u("div",{children:[e("form",{onSubmit:async c=>{var I,P,E,O;c.preventDefault();const s=[],h=M.filter(a=>B.includes(a.id));if(h.length)for(let a=0;a<h.length;a++){let m;h[a].usdBase&&f?m=(parseFloat(h[a].amount)*((P=(I=A[f[h[a].currency].name])==null?void 0:I.tokenPrice)!=null?P:1)).toString():m=h[a].amount,s.push({toAddress:h[a].address,amount:m,tokenName:h[a].currency,member:h[a]});let d=h[a].secondaryAmount,L=h[a].secondaryCurrency;d&&L&&f&&(h[a].secondaryAmount&&(d=(parseFloat(d)*((O=(E=A[f[h[a].secondaryCurrency].name])==null?void 0:E.tokenPrice)!=null?O:1)).toFixed(4)),s.push({toAddress:h[a].address,amount:d,tokenName:L}))}W(!0);try{if(n.accountAddress.toLowerCase()===N.toLowerCase()&&f){if(s.length===1){if(await j({coin:f[s[0].tokenName],recipient:s[0].toAddress,amount:s[0].amount},{interval:"instant"},[l.find(a=>a.id==="Payroll")]),s[0].member&&!(t!=null&&t.request)){let a=x({},s[0].member);const m=a.interval===te.monthly,d=new Date(a.paymantDate).getTime()<new Date().getTime();a.paymantDate=m?U.addMonths(d?new Date:new Date(a.paymantDate),1).toISOString():U.addDays(d?new Date:new Date(a.paymantDate),7).toISOString(),a.name=v(`${a.name}`,n==null?void 0:n.encryptedMessageToken),a.address=v(a.address,n==null?void 0:n.encryptedMessageToken),a.amount=v(a.amount,n==null?void 0:n.encryptedMessageToken),a.secondaryAmount&&(a.secondaryAmount=v(a.secondaryAmount,n==null?void 0:n.encryptedMessageToken)),await o(a.teamId,a.id,a)}}else if(s.length>1&&f){const a=s.map(m=>({coin:f[m.tokenName],recipient:m.toAddress,amount:m.amount,from:!0}));await V(a,void 0,[l.find(m=>m.id==="Payroll")]);for(let m=0;m<s.length;m++)if(s[m].member&&!(t!=null&&t.request)){let d=x({},s[m].member);const L=d.interval===te.monthly,H=new Date(d.paymantDate).getTime()<new Date().getTime();d.paymantDate=L?U.addMonths(H?new Date:new Date(d.paymantDate),1).toISOString():U.addDays(H?new Date:new Date(d.paymantDate),7).toISOString(),d.name=v(`${d.name}`,n==null?void 0:n.encryptedMessageToken),d.address=v(d.address,n==null?void 0:n.encryptedMessageToken),d.amount=v(d.amount,n==null?void 0:n.encryptedMessageToken),d.secondaryAmount&&(d.secondaryAmount=v(d.secondaryAmount,n==null?void 0:n.encryptedMessageToken)),await o(d.teamId,d.id,d)}}}else if(s.length===1&&f)await D(N,[{recipient:s[0].toAddress,amount:s[0].amount,coin:f[s[0].tokenName]}]);else if(s.length>1&&f){const a=s.map(m=>({coin:f[m.tokenName],recipient:m.toAddress,amount:m.amount,from:!0}));await D(N,a)}G(!0),C()}catch(a){console.error(a),T(ee({activate:!0,text:a.message}))}W(!1)},children:e("div",{className:"flex flex-col items-center justify-start min-h-screen",children:u("div",{className:"w-[95%] sm:w-[85vw] min-h-[75vh] py-10",children:[e("div",{className:"w-full",children:e("div",{className:"text-xl text-center font-semibold py-5",children:"Mass Payout"})}),e("div",{className:" h-auto rounded-xl flex flex-col gap-10 py-10",children:i&&i.length===0?e("div",{className:"flex justify-center",children:"No Team Yet. Please, first, create a team"}):u(ae,{children:[u("div",{className:"flex flex-col px-4 sm:pl-12 sm:pr-[20%] gap-10",children:[u("div",{className:"flex flex-col space-y-3",children:[e("span",{className:"text-left text-sm font-semibold",children:"Paying From"}),e("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-x-3 sm:gap-x-10",children:i&&g?e(q,{className:"h-full",disableAddressDisplay:!0,onSelect:R,nameActivation:!0,selected:g,list:i.map(c=>({name:c.name,address:c.id}))}):e(Se,{})})]}),u("div",{className:"flex flex-col space-y-3",children:[e("span",{className:"text-left text-sm font-semibold",children:"Tags"}),u("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-x-3 sm:gap-x-10",children:[l.length>0&&u("div",{className:"flex space-x-3 border rounded-lg items-center px-2 py-3 dark:border-darkSecond",children:[e("div",{className:"w-[1.125rem] h-[1.125rem] rounded-full",style:{backgroundColor:(z=l.find(c=>c.name=="Payroll"))==null?void 0:z.color}}),e("div",{children:"Payroll"})]}),l.length===0&&e("div",{children:"No tag yet"})]})]}),u("div",{className:"flex flex-col",children:[u("div",{className:"flex justify-between py-4 items-center",children:[e("span",{className:"text-left font-semibold",children:"Team Details"}),u("div",{className:"flex space-x-2 items-center",children:[e("input",{type:"checkbox",className:"relative cursor-pointer w-[1.25rem] h-[1.25rem] checked:before:absolute checked:before:w-full checked:before:h-full checked:before:bg-primary checked:before:block",onChange:c=>{c.target.checked?F(M.map(s=>s.id)):F([])}}),e("div",{children:"Select All"})]})]}),u("div",{className:"grid grid-cols-2 sm:grid-cols-[20%,42%,33%,5%] gap-5",children:[e("div",{className:"hidden sm:block font-semibold",children:"Name"}),e("div",{className:"hidden sm:block font-semibold",children:"Address"}),e("div",{className:"hidden sm:block font-semibold",children:"Disbursement"}),e("div",{className:"hidden sm:block"}),i&&M&&K&&K.length>0?M.map((c,s)=>e(Ce,b(x({selectedId:B,setSelectedId:F,index:s},c),{members:M,setMembers:Y}),c.id)):"No Member Yet"]})]}),u("span",{className:"text-lg",children:["Total: $ ",Object.values(M.filter(c=>B.includes(c.id))).reduce((c,s,h)=>{var I,P,E,O;return f?(s.secondaryCurrency&&s.secondaryAmount&&(s.usdBase?c+=parseFloat(s.secondaryAmount):c+=parseFloat(s.secondaryAmount)*((P=(I=A[f[s.secondaryCurrency].name])==null?void 0:I.tokenPrice)!=null?P:1)),s.usdBase?c+parseFloat(s.amount):c+parseFloat(s.amount)*((O=(E=A[f[s.currency].name])==null?void 0:E.tokenPrice)!=null?O:1)):c},0).toFixed(2)]}),u("div",{className:"flex flex-col space-y-3",children:[e("span",{className:"text-left",children:"Description (Optional)"}),e("div",{className:"grid grid-cols-1",children:e("textarea",{className:"border-2 rounded-xl p-1 outline-none dark:bg-darkSecond dark:border-darkSecond",name:"description",id:"",cols:30,rows:5})})]})]}),e("div",{className:"flex justify-center",children:u("div",{className:"flex flex-col-reverse sm:grid sm:grid-cols-2 w-[25rem] justify-center gap-5",children:[e(Z,{version:"second",onClick:()=>k("/dashboard"),children:"Close"}),e(Z,{type:"submit",isLoading:p,children:"Pay"})]})})," "]})})]})})}),se&&e(we,{onClose:G,onAction:()=>{k("/dashboard")}}),S&&e(Ae,{onClose:c=>T(ee({activate:!1,text:""}))})]})};export{Le as default};
